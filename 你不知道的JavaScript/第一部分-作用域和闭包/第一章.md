# 第一章 作用域是什么

作用域:一套用来存贮变量并且之后可以方便的找到这些对象的**规则**.

#### 编译原理

- JavaScript是一门编译语言(但是与传统的编译语言不同,他不是提前编译的,也不能在分布式系统中进行移植)
- 词法分析
  - ​
- 语法分析
  - 这是将此法单元流(数组)转换成一个由元素主机嵌套所组成的代表了程序语法结构的树.这个树被称为"抽象语法树"(Abstract Syntax Tree AST)
- 代码生成
  - 就是将ATS转化为一组机器指令

任何JavaScript代码片段在**执行前都要进行编译**(通常就在执行前)

#### 理解作用域(var a=2;为例子)

- 演员表
  - 引擎:	从头到尾负责整个JavaScript程序的编译及执行过程
  - 编译器:     引擎的朋友之一,负责语法分析和代码生成等脏活累活
  - 作用域:      引擎的朋友之一,负责收集并维护由所有声明的标识符(变量)组成的一系列查询,并实施一套非常严格的规则,确定当前执行的代码对这些标识符的访问权限.
- 总结
  - 变量的赋值操作会执行两个动作,首先编译器会在当前作用域中声明一个变量(如果之前没有声明过),然后在运行时引擎会在作用域中查找该变量,如果能够找到就会对它赋值.
- 编译器有话说
  - ​

### 总结

JavaScript引擎首先会在代码执行前对其进行编译,这个过程中,像var a=2这样的声明会被分解成两个独立的步骤:

- 首先,var a在其作用域中声明新变量. 这会在最开始的阶段,也就是代码执行前进行.
- 接下里,a=2会查询(LHS查询)变量a并对其进行赋值

LHS和RHS查询都会在当前执行作用域中开始,如果有需要(也就是说他们没有找到所需的标识符),就会向上级作用域继续查找目标标识符,这样每次上升一级作用域直到全局作用域,无论找没找到都会停止.

不成功的RHS引用会导致抛出ReferenceError异常.不成功的LHS引用会导致自动隐式地创建一个全局变量(非严格模式下),该变量使用LHS引用的目标作为标识符,或者抛出ReferenceError异常(严格模式下)